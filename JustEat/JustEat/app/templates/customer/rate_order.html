{% extends "layout.html" %}

{% block title %}
JustEat | Restaurants
{% endblock %}

{% block navbar %}
{% include "partials/_customer_navbar.html" %}
{% endblock %}

{% block content %}
<form method="POST" action="{{ url_for('customer.add_review', order_id=order.id) }}"
    class="container my-4 p-3 mx-auto" novalidate>

    <h2 class="mb-4 text-center">Order from {{ order.restaurant.name|title }}</h2>

    {{ form.hidden_tag() }}

    <div class="d-flex flex-column flex-md-row">
        <div class="w-100 p-3 d-flex flex-column ">
            <h4 class="text-center">Restaurant Review</h4>
            <div class="form-group mb-3">
                {{ form.restaurant_review.rating.label(class="form-label") }}
                {{ form.restaurant_review.rating(class="form-select") }}
                {% for error in form.restaurant_review.rating.errors %}
                <small class="text-danger">{{ error }}</small>
                {% endfor %}
            </div>

            <div class="form-group">
                {{ form.restaurant_review.review.label(class="form-label") }}
                {{ form.restaurant_review.review(class="form-control", rows=3,
                placeholder="How was you order from "~(order.restaurant.name)) }}
            </div>

            {{ form.submit(class="btn btn-primary mx-auto max-w-xs w-100 mt-3") }}
        </div>
        <div class="w-100 p-3">
            <h4 class="text-center">Item Reviews</h4>
            {% for item_review in form.item_reviews %}
            {% set item = order.items[loop.index0] %}
            <div class="form-group mb-3">
                <label class="form-label">{{ item.name|title }}</label>
                {{ item_review.rating(class="form-select") }}
            </div>
            <input type="hidden" name="item_reviews-{{ loop.index0 }}-item_id" value="{{ item.menu_item_id }}">
            {% endfor %}
        </div>
    </div>

</form>
{% endblock %}